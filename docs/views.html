<!DOCTYPE html>

<html>
<head>
  <title>views.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="core.html">
                  core.js
                </a>
              
                
                <a class="source" href="models.html">
                  models.js
                </a>
              
                
                <a class="source" href="views.html">
                  views.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>views.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @file
 * Curricula UI JS application views.
 *
 * This defines the views used throughout the application. Note that this file
 * is written using Docco syntax. If Node is installed, you can generate this
 * documentation by running:
 *
 *   npm install
 *   npm run doc
 *
 * This will generate the documentation in the docs/ folder, in HTML format.
 */</span>
<span class="hljs-meta">
"use strict"</span>;
( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> Backbone, _, c </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>This defines the views used throughout the application. Almost all parts are
split into independent views, allowing for maximum flexibility and
re-usability. It extends the global <code>CurriculaUI</code> namespace, aliased
to <code>c</code> for readability.</p>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="a-note-on-backbone">A note on Backbone</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>As all the views are extending <em>Backbone</em>, it is useful to see the
official documentation on <a href="http://backbonejs.org/#View">Backbone.View</a>.</p>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="templates">Templates</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>This defines the default templates used by the views in the application. They
can be overridden in various cases, as needed. Curricula UI strictly
adheres to <em>BEM</em> notation for the markup, and overrides should follow suit.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.templates = _.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>A single item.</p>
<p>This template is mainly used by <code>ItemView</code>, and represents a single item
in a list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  item: <span class="hljs-string">'\
&lt;% if ( editable ) { %&gt;\
  &lt;input type="checkbox" value="model-&lt;%= id %&gt;"&lt;% if ( active ) { %&gt; checked&lt;% } %&gt;/&gt;\
&lt;% } %&gt;\
&lt;% for ( var i in name ) { %&gt;\
  &lt;%= name[ i ] %&gt;\
  &lt;% if ( i &lt; name.length - 1 ) {%&gt;&lt;hr /&gt;&lt;% } %&gt;\
&lt;% } %&gt;\
&lt;% if ( hasChildren ) { %&gt;\
  &lt;i class="icon-chevron-right" /&gt;\
&lt;% } %&gt;\
'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>A list of items.</p>
<p>This template is mainly used by <code>ItemListView</code>, and represents a list of
items, usually ItemViews. Note that it uses classes for the <em>nanoScroller</em>
jQuery plugin for convenience.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  itemList: <span class="hljs-string">'\
&lt;div class="curricula-ui__column__wrapper nano"&gt;\
  &lt;ul class="curricula-ui__column__wrapper__list nano-content"&gt;&lt;/ul&gt;\
&lt;/div&gt;\
&lt;span class="curricula-ui__column__button curricula-ui__column__button--show-parent"&gt;\
  &lt;i class="icon-chevron-left" /&gt; Back\
&lt;/span&gt;\
&lt;span class="curricula-ui__column__button curricula-ui__column__button--show-root"&gt;\
  &lt;i class="icon-chevron-left" /&gt;&lt;i class="icon-chevron-left" /&gt; Top\
&lt;/span&gt;\
'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Information about a specific item.</p>
<p>Used to display more detailed information about an item. This is most
certainly the best candidate for an override, as it greatly depends on
context. It provides a sensible default template, with very little
information other than a link. Mainly used by <code>ItemInfoView</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  itemInfo: <span class="hljs-string">'\
&lt;h3 class="curricula-ui-item-info__label"&gt;\
  &lt;%= typeof itemInfoLabel !== "undefined" ? itemInfoLabel : "Item info" %&gt;\
&lt;/h3&gt;\
&lt;div class="curricula-ui-item-info__content nano"&gt;\
  &lt;div class="nano-content"&gt;\
    &lt;% if ( typeof name === "undefined" ) { %&gt;\
      &lt;span class="curricula-ui-item-info-view__empty"&gt;Select an item to see its information&lt;/span&gt;\
    &lt;% } else { %&gt;\
      &lt;%= name %&gt;\
    &lt;% } %&gt;\
  &lt;/div&gt;\
&lt;/div&gt;\
'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Summary tree.</p>
<p>This template is meant to be used recursively. It is used to construct a
summary of the current application state. It is mainly used by
<code>SummaryTreeView</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  summaryList: <span class="hljs-string">'\
&lt;li\
  data-model-id="&lt;%= id %&gt;"\
  class="curricula-ui-summary__list__item"\
&gt;\
  &lt;span&gt;\
    &lt;% for ( var i in name ) { %&gt;\
      &lt;%= name[ i ] %&gt;\
      &lt;% if ( i &lt; name.length - 1 ) {%&gt;&lt;hr /&gt;&lt;% } %&gt;\
    &lt;% } %&gt;\
  &lt;/span&gt;\
  &lt;%= children %&gt;\
&lt;/li&gt;\
'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Search.</p>
<p>Used for the quick search component, which allows users to quickly jump
to a specific item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  search: <span class="hljs-string">'\
&lt;div class="curricula-ui-search__overlay"&gt;&lt;/div&gt;\
&lt;div class="curricula-ui-search__wrapper"&gt;\
  &lt;input type="text" class="curricula-ui-search__input" /&gt;\
  &lt;i class="curricula-ui-search__cancel icon icon-close" /&gt;\
&lt;/div&gt;\
'</span>

}, c.templates || {});</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2 id="item-view">Item view</h2>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>This view represents a single item in a column. It requires a model
representing the item, usually a <code>CurriculaUI.ItemModel</code>. See
<code>models.js</code> for more information.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.ItemView = Backbone.View.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>The item is rendered as a list item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tagName:   <span class="hljs-string">'li'</span>,
  <span class="hljs-attr">className</span>: <span class="hljs-string">'curricula-ui__column__wrapper__list__item'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>It uses the <code>item</code> template from our templates list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tpl: _.template( c.templates.item ),</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>This hash keeps track of the view settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  settings: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The item view can react to multiple events, most notably, for <em>editable</em>
items, the (un)checking of the checkbox, resulting in a change of state
of the linked model.</p>
<p>Other events include the selecting of the item as a whole, or the
double-click, which is a shortcut of (un)checking the checkbox for
<em>editable</em> items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  events: {
    <span class="hljs-string">"change input"</span>: <span class="hljs-string">"updateModel"</span>,
    <span class="hljs-string">"click input"</span>:  <span class="hljs-string">"updateModel"</span>,
    <span class="hljs-string">"click"</span>:        <span class="hljs-string">"triggerSelect"</span>,
    <span class="hljs-string">"dblclick"</span>:     <span class="hljs-string">"doubleClick"</span>
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Upon initialization, the view checks if a usable model is provided. If not,
it will throw an exception.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> settings </span>) </span>{
    <span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.model ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an ItemView without a model."</span>;
    }
    <span class="hljs-keyword">var</span> errors = <span class="hljs-keyword">this</span>.model.validate();
    <span class="hljs-keyword">if</span> ( errors &amp;&amp; errors.length ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an ItemView with an invalid model. Errors: "</span> + errors.join( <span class="hljs-string">', '</span> );
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Store the passed settings, providing defaults.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.settings = _.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Whether the item is editable or not. Defaults to <code>false</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      editable: <span class="hljs-literal">false</span>
    }, settings || {});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>The view will react on model state changes, either re-rendering itself
or removing itself completely from the DOM. When such events are
triggered by the model, the view itself will trigger a corresponding
<code>model:*</code> event, which will allow events to bubble up the application
hierarchy.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.model
      .bind( <span class="hljs-string">'change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        that.render();
      })
      .bind( <span class="hljs-string">'destroy'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        that.trigger( <span class="hljs-string">'model:destroy'</span>, that.model, that );
        that.remove();
      });
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Render the item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.empty();</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>We set many modifier classes based on the model’s values. However, we set
these on our $el element itself, not its child elements. This means we
have to set these classes here instead of through the template.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el
      .toggleClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--active'</span>, !!<span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'active'</span> ) )
      .toggleClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--has-children'</span>, !!<span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'hasChildren'</span> ) )
      .toggleClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--expanded'</span>, !!<span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'expanded'</span> ) )
      .toggleClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--highlighted'</span>, !!<span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'highlighted'</span> ) ) ;</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>We check all the data elements we have. If some of the root data elements
are boolean values, we treat them as modifier flags for convenience.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'data'</span> ) !== <span class="hljs-string">'undefined'</span> ) {
      <span class="hljs-keyword">var</span> data = <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'data'</span> );
      <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> data ) {
        <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> data[ key ] === <span class="hljs-string">'boolean'</span> ) {
          <span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--'</span> + <span class="hljs-keyword">this</span>.cleanupClassName( key ), !!data[ key ] );
        }
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Finally, add a modifier class based on the element’s type.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'type'</span> ) !== <span class="hljs-string">'undefined'</span> ) {
      <span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--'</span> + <span class="hljs-keyword">this</span>.cleanupClassName( <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'type'</span> ) ) );
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Set an attribute based on the model’s ID.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.attr( <span class="hljs-string">'data-model-id'</span>, <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'id'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>And set an ID as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.attr( <span class="hljs-string">'id'</span>, <span class="hljs-keyword">this</span>.className + <span class="hljs-string">'--'</span> + <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'id'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Prepare the template variables based on the model’s values. We also pass
some of our view’s attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> variables = <span class="hljs-keyword">this</span>.model.toJSON();
    variables.editable = <span class="hljs-keyword">this</span>.settings.editable;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Preprocess the name, as it can contain newlines, which have to be
translated to <br> tags.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> variables.name !== <span class="hljs-string">'undefined'</span> ) {
      <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> variables.name ) {
        variables.name[ i ] = variables.name[ i ].trim().replace( <span class="hljs-regexp">/(?:\r\n|\r|\n)/g</span>, <span class="hljs-string">'&lt;br /&gt;'</span> );
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Render the template.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.tpl( variables ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Trigger a <code>render</code> event, so other parts of the application can interact
with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Event handler for when the checkbox is clicked. Based on the new checkbox
state, the model’s <code>active</code> attribute will be set to <code>true</code> (checked) or
<code>false</code> (unchecked). The view will also trigger 2 more events:</p>
<ul>
<li>a <code>model:change</code> event, which applies to the model.</li>
<li>either a <code>active</code> or <code>unactive</code> event, which applies to the view itself.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>  updateModel: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'active'</span>, <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'input'</span> ).is( <span class="hljs-string">':checked'</span> ) );
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'model:change'</span>, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );
    <span class="hljs-keyword">this</span>.triggerActiveChange();
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Event handler for when the view is clicked. This triggers a <code>select</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerSelect: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'select'</span>, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Event handler for when the view is double-clicked. This is a shortcut for
toggling the state of the checkbox, and will trigger the same 2 events as
<code>ItemView#updateModel()</code>:</p>
<ul>
<li>a <code>model:change</code> event, which applies to the model.</li>
<li>either a <code>active</code> or <code>unactive</code> event, which applies to the view itself.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>  doubleClick: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>We stop the propagation immediately, in order to prevent triggering our
handler more than once.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    e.stopPropagation();

    <span class="hljs-keyword">this</span>.model.set( <span class="hljs-string">'active'</span>, !<span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'input'</span> ).is( <span class="hljs-string">':checked'</span> ) );
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'model:change'</span>, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );
    <span class="hljs-keyword">this</span>.triggerActiveChange();
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Helper function to trigger an <em>active</em> state chance event. Will trigger
either an <code>active</code> or an <code>unactive</code> event, based on the state of the model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerActiveChange: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.model.get( <span class="hljs-string">'active'</span> );
    <span class="hljs-keyword">this</span>.trigger( state ? <span class="hljs-string">'active'</span> : <span class="hljs-string">'unactive'</span>, state, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Cleanup string that’s to be used as a class name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  cleanupClassName: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> string </span>) </span>{
    <span class="hljs-keyword">return</span> string.replace( <span class="hljs-regexp">/([^a-z0-9_\-]+)/gi</span>, <span class="hljs-string">''</span> );
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h2 id="item-list-view">Item list view</h2>

            </div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>This view represents a list of items. It requires a collection containing
all items in this list, usually a <code>CurriculaUI.ItemCollection</code>. See
<code>models.js</code> for more information.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.ItemListView = Backbone.View.extend({
  <span class="hljs-attr">className</span>: <span class="hljs-string">'curricula-ui__column'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>It uses the <code>itemList</code> template from our templates list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tpl: _.template( c.templates.itemList ),</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>This array keeps track of all child views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  childViews: [],</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>This hash keeps track of the view settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  settings: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>The item view can react to 2 events, which are related to navigating the
application. Each list contains 2 buttons, a <em>Back</em> button, and a <em>Top</em>
button. Both trigger a specific event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  events: {
    <span class="hljs-string">"click .curricula-ui__column__button--show-parent"</span>: <span class="hljs-string">"triggerGoBack"</span>,
    <span class="hljs-string">"click .curricula-ui__column__button--show-root"</span>:   <span class="hljs-string">"triggerGoToBeginning"</span>
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Upon initialization, the view checks if a usable collection is provided.
If not, it will throw an exception.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> settings </span>) </span>{
    <span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.collection ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an ItemListView without a collection."</span>;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Store the passed settings, providing defaults.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.settings = _.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Whether the child items are editable or not. Defaults to <code>false</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      editable:  <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>What View to use for the child view. Defaults to <code>c.ItemView</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      childView: c.ItemView
    }, settings || {});</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>The view will react on collection state changes, re-rendering itself
every time. When such events are triggered by the collection, the view
itself will trigger a corresponding <code>collection:*</code> event, which will
allow events to bubble up the application hierarchy.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.collection
      .bind( <span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
        that.trigger( <span class="hljs-string">'collection:add'</span>, model, that.collection, that );
        that.render();
      })
      .bind( <span class="hljs-string">'remove'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{
        that.trigger( <span class="hljs-string">'collection:remove'</span>, model, that.collection, that );
        that.render();
      });
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Render the item list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Completely empty the wrapper; start with a blank slate.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.childViews.length ) {
      <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.childViews.length - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; --i ) {
        <span class="hljs-keyword">this</span>.childViews[ i ].remove();
      }
    }
    <span class="hljs-keyword">this</span>.childViews = [];
    <span class="hljs-keyword">this</span>.$el.empty();
    <span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.tpl() );

    <span class="hljs-keyword">var</span> $ul = <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'ul'</span> ),
        that = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Go through the collection, and create a new child view for each model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.collection.forEach( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Prepare the child view, and register it with our view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> item = <span class="hljs-keyword">new</span> that.settings.childView({ <span class="hljs-attr">model</span>: model, <span class="hljs-attr">editable</span>: that.settings.editable });
      that.childViews.push( item );</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Listen on certain events the child view can trigger. This will allow
us to let them bubble up the hierarchy.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      item
        .on( <span class="hljs-string">'model:change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          that.triggerItemEvent( <span class="hljs-string">'change'</span>, model );
        })
        .on( <span class="hljs-string">'select'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          that.triggerItemEvent( <span class="hljs-string">'select'</span>, model );
        })
        .on( <span class="hljs-string">'render'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          that.triggerItemEvent( <span class="hljs-string">'render'</span>, model, item );
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Render the item and add it to our markup.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      $ul.append( item.render().$el );
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Trigger a <code>render</code> event, so other parts of the application can interact
with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Helper function to collapse the list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  collapse: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.addClass( <span class="hljs-string">'curricula-ui__column--collapsed'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Trigger a <code>column:collapse</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'column:collapse'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Helper function to expand the list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  expand: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.removeClass( <span class="hljs-string">'curricula-ui__column--collapsed'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Trigger a <code>column:expand</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'column:expand'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Helper function to check whether the list is collapsed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  isCollapsed: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$el.hasClass( <span class="hljs-string">'curricula-ui__column--collapsed'</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Helper function to check whether the list is expanded.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  isExpanded: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.isCollapsed();
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Helper function to trigger an <code>item:*</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerItemEvent: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, itemModel, itemView </span>) </span>{
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> itemView !== <span class="hljs-string">'undefined'</span> ) {
      <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'item:'</span> + event, itemModel, itemView, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'item:'</span> + event, itemModel, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
    }
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Event handler for when the <em>Back</em> button is clicked. Triggers a
<code>column:go-back</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerGoBack: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'column:go-back'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Event handler for when the <em>Top</em> button is clicked. Triggers a
<code>column:go-to-root</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerGoToBeginning: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'column:go-to-root'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <h2 id="item-info-view">Item info view</h2>

            </div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>This view represents information about an item.  It requires a model
representing the item, usually a <code>CurriculaUI.ItemModel</code>. See
<code>models.js</code> for more information.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.ItemInfoView = Backbone.View.extend({
  <span class="hljs-attr">className</span>: <span class="hljs-string">'curricula-ui-item-info'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>It uses the <code>itemList</code> template from our templates list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tpl: _.template( c.templates.itemInfo ),</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>The item info view can be collapsed by clicking on its label.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  events: {
    <span class="hljs-string">"click .curricula-ui-item-info__label"</span>: <span class="hljs-string">"toggleCollapse"</span>
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Upon initialization, the view checks if a usable model is provided. If not,
it will throw an exception.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.model ) {
      <span class="hljs-keyword">var</span> errors = <span class="hljs-keyword">this</span>.model.validate();
      <span class="hljs-keyword">if</span> ( errors &amp;&amp; errors.length ) {
        <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an ItemInfoView with an invalid model. Errors: "</span> + errors.join( <span class="hljs-string">', '</span> );
      }
    }
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Render the item information.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Start with a blank slate.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.empty();</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Prepare the template variables and render the template.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> variables = <span class="hljs-keyword">this</span>.model ? <span class="hljs-keyword">this</span>.model.toJSON() : {};
    <span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.tpl( variables ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Trigger a <code>render</code> event, so other parts of the application can interact
with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>   <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>.model, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Collapse or expand the item information element, based on its previous
state. This will trigger a expand or collapse event, so other parts of the
application can react to this action.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  toggleCollapse: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.toggleClass( <span class="hljs-string">'curricula-ui-item-info--expanded'</span> );
    <span class="hljs-keyword">this</span>.trigger(
      <span class="hljs-keyword">this</span>.$el.hasClass( <span class="hljs-string">'curricula-ui-item-info--expanded'</span> ) ? <span class="hljs-string">'expand'</span> : <span class="hljs-string">'collapse'</span>,
      <span class="hljs-keyword">this</span>.model,
      <span class="hljs-keyword">this</span>
    );
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <h2 id="summary-tree-view">Summary tree view</h2>

            </div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>This view represents information about the state of the application. When
items are selected, their <code>active</code> attribute is set to <code>true</code>. Based on this
information, we can construct a summary of all active items. As the data is
a hierarchy, we display it as a recursively rendered tree.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.SummaryTreeView = Backbone.View.extend({
  <span class="hljs-attr">className</span>: <span class="hljs-string">'curricula-ui-summary'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>It uses the <code>summaryList</code> template from our templates list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tpl: _.template( c.templates.summaryList ),</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>The summary view can react to multiple events, most importantly the <code>click</code>
event. This will trigger a <code>item:select</code> event, which will allow
other parts of the application to react accordingly. Other events are
<code>mouseover</code> and <code>mouseout</code>  events. These trigger the toggling of CSS
classes, which can be used to highlight structural information.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  events: {
    <span class="hljs-string">"mouseover li &gt; span"</span>: <span class="hljs-string">"mouseOver"</span>,
    <span class="hljs-string">"mouseout li &gt; span"</span>:  <span class="hljs-string">"mouseOut"</span>,
    <span class="hljs-string">"click li"</span>:            <span class="hljs-string">"triggerSelect"</span>
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Upon initialization, the view checks if a usable collection is provided.
If not, it will throw an exception.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.collection ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an SummaryTreeView without a collection."</span>;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>The view will react on collection state changes, re-rendering itself
every time.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.collection
      .bind( <span class="hljs-string">'change remove add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        that.render();
      });
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>Render the summary tree.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>The <code>SummaryTreeView#render()</code> method can be called very often, sometimes
several times per ms. We don’t want that. So, we put  a little timeout
and wait. If the render function hasn’t been called again for a certain
time, we proceed with the rendering. Otherwise, we cancel the render, and
wait again.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.timeout !== <span class="hljs-string">'undefined'</span> ) {
      <span class="hljs-keyword">this</span>.timeout = clearTimeout( <span class="hljs-keyword">this</span>.timeout );
    }
    <span class="hljs-keyword">this</span>.timeout = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      that.realRender();
      that.timeout = clearTimeout( that.timeout );
    }, <span class="hljs-number">10</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Actual render callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  realRender: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.empty();
    <span class="hljs-keyword">this</span>.$el.append( <span class="hljs-keyword">this</span>.recursiveRender( <span class="hljs-string">'root'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Trigger a <code>render</code> event, so other parts of the application can interact
with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Helper function to recursively render the summary tree, starting at the
passed parent ID.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  recursiveRender: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> parentId </span>) </span>{
    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>,
        children = <span class="hljs-keyword">this</span>.collection.where({ <span class="hljs-attr">parentId</span>: parentId, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> }),
        html = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">if</span> ( children.length ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>Render a list of child items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      html = <span class="hljs-string">'&lt;ul class="curricula-ui-summary__list"&gt;'</span>;
      children.forEach( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> model </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Render a single item. Recursively get the child markup by calling
<code>SummaryTreeView#recursiveRender()</code> again.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> variables = model.toJSON();
        variables.children = that.recursiveRender( model.get( <span class="hljs-string">'id'</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Cleanup the name. Some elements contain HTML, and our summary tree is
quite fragile.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> tmp;
        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> variables.name ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>Trick to strip an element of all markup.
See <a href="http://stackoverflow.com/questions/5002111/javascript-how-to-strip-html-tags-from-string">http://stackoverflow.com/questions/5002111/javascript-how-to-strip-html-tags-from-string</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          tmp = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'div'</span> );
          tmp.innerHTML = variables.name[ i ];
          variables.name[ i ] = tmp.textContent || tmp.innerText || variables.name[ i ];
        }

        html += that.tpl( variables );
      });
      html += <span class="hljs-string">'&lt;/ul&gt;'</span>;
    }

    <span class="hljs-keyword">return</span> html;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Event handler for <code>mouseover</code> events. Stop the bubbling up of the event,
so we can distinguish which exact (sub)tree got hovered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  mouseOver: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{
    e.stopPropagation();
    <span class="hljs-keyword">this</span>.$( e.target )
      .parent().addClass( <span class="hljs-string">'hover'</span> )
        .parents( <span class="hljs-string">'li'</span> ).addClass( <span class="hljs-string">'child-hovered'</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>Event handler for <code>mouseout</code> events. Undo the modifications done by the
<code>mouseover</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  mouseOut: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{
    <span class="hljs-keyword">this</span>.$( e.target )
      .parent().removeClass( <span class="hljs-string">'hover'</span> )
        .parents( <span class="hljs-string">'li'</span> ).removeClass( <span class="hljs-string">'child-hovered'</span> );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Event handler for clicking on an item in the tree. Stop the bubbling up
of the event, and trigger a <code>item:select</code> event, so other parts
of the application can react to it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerSelect: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> e </span>) </span>{
    e.stopPropagation();
    <span class="hljs-keyword">var</span> itemModel = <span class="hljs-keyword">this</span>.collection.get(
      <span class="hljs-keyword">this</span>.$( e.currentTarget ).attr( <span class="hljs-string">'data-model-id'</span> )
    );
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'item:select'</span>, itemModel, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
  }
});</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <h2 id="search-view">Search view</h2>

            </div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>This view allows users to search for items in the database. It filters the
application collection, and shows a number of selectable results.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>c.SearchView = Backbone.View.extend({
  <span class="hljs-attr">className</span>: <span class="hljs-string">'curricula-ui-search'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>It uses the <code>search</code> template from our templates list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tpl: _.template( c.templates.search ),</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Upon initialization, the view checks if a usable collection is provided.
If not, it will throw an exception.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.collection ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"Cannot initialize an SearchView without a collection."</span>;
    }
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>Upon removing a view, make sure the autocomplete is completely destroyed
as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'input'</span> ).autocomplete( <span class="hljs-string">'destroy'</span> );
    <span class="hljs-keyword">this</span>.$el.remove();
    <span class="hljs-keyword">this</span>.stopListening();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>Helper method to see if an item from the database matches the searched
term. This method can be overridden if needed, to provide more fine-grained
searches.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  isMatch: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> term, item </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>@todo What about special chars? ‘e’ should match ‘é’, ‘è’, and ‘e’.
@todo Remove special chars that have meaning, like “(“ or “[“.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> regExp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>( term.replace( <span class="hljs-regexp">/([^a-z0-9_\-\u00E0-\u00FC\s]+)/gi</span>, <span class="hljs-string">''</span> ), <span class="hljs-string">'gi'</span> ),
        name = item.get( <span class="hljs-string">'name'</span> );

    <span class="hljs-keyword">return</span> (</pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>First try the ID, as it is the easiest and fastest to match.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      regExp.test( item.get( <span class="hljs-string">'id'</span> ) ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>Next try the first name. Most items have only one, so this will save
an expensive <code>join()</code> call.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      regExp.test( name[ <span class="hljs-number">0</span> ] ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Still no match, so we check if we need to join, and if so, join with
spaces. This is the most expensive one, so we really try to avoid it
if possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      ( name.length &gt; <span class="hljs-number">1</span> &amp;&amp; regExp.test( name.join( <span class="hljs-string">' '</span> ) ) )
    );
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>Render the search component.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.$el.empty();
    <span class="hljs-keyword">this</span>.$el.append( <span class="hljs-keyword">this</span>.tpl() );

    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>We cannot use the <code>events</code> hash of our view, because it tends to get
completely removed often. Instead, bind our click handler here.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'.curricula-ui-search__cancel, .curricula-ui-search__overlay'</span> ).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      that.triggerCancel();
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Activate the jQuery UI Autocomplete widget.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.$el.find( <span class="hljs-string">'input'</span> ).autocomplete({
      <span class="hljs-attr">select</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, ui </span>) </span>{
        that.trigger( <span class="hljs-string">'select'</span>, that.collection.get( ui.item.value ), that.collection, that );
      },
      <span class="hljs-attr">source</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> request, response </span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Methods like <code>each()</code> or <code>filter()</code> loop over all items before
exiting. We don’t want that. As soon as we find 10, we stop.
Databases can contain many thousands of items, and performance is
important. This is why we use the <code>every()</code> method, and scope the
data variable outside of it. This will allow us to stop iterating as
soon as we have 10 elements to show.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> data = [],
            i = <span class="hljs-number">10</span>,
            tmp, name;

        that.collection.every( <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> item </span>) </span>{
          <span class="hljs-keyword">if</span> ( i ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>We haven’t found 10 items yet. Check if this item matches the
search term.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> ( that.isMatch( request.term, item ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Trick to strip an element of all markup.
See <a href="http://stackoverflow.com/questions/5002111/javascript-how-to-strip-html-tags-from-string">http://stackoverflow.com/questions/5002111/javascript-how-to-strip-html-tags-from-string</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              name = item.get( <span class="hljs-string">'name'</span> ).join( <span class="hljs-string">' '</span> );
              tmp = <span class="hljs-built_in">document</span>.createElement( <span class="hljs-string">'div'</span> );
              tmp.innerHTML = name;
              name = tmp.textContent || tmp.innerText || name;

              data.push({
                <span class="hljs-attr">label</span>: name,
                <span class="hljs-attr">value</span>: item.get( <span class="hljs-string">'id'</span> )
              });

              --i;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>Continue filtering the items.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
          }</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>i === 0, so we must stop now.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } );</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>Allow other parts of the application to alter the results, if needed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        that.trigger( <span class="hljs-string">'results'</span>, data, that.collection, that );</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>Pass the response back.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        response( data );
      }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>Trigger a <code>render</code> event, so other parts of the application can interact
with it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>Allow the chaining of method calls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Trigger a cancel event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  triggerCancel: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">'cancel'</span>, <span class="hljs-keyword">this</span>.collection, <span class="hljs-keyword">this</span> );
  }
});

})( Backbone, _, <span class="hljs-built_in">window</span>.CurriculaUI || ( <span class="hljs-built_in">window</span>.CurriculaUI = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>() ) );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
